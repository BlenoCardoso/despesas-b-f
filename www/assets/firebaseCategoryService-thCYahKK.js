var y=Object.defineProperty;var w=(n,a,o)=>a in n?y(n,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[a]=o;var u=(n,a,o)=>w(n,typeof a!="symbol"?a+"":a,o);import{s as D,a as f,c as d,d as i,q as h,w as m,o as p,g as C,b as E,e as B,u as A}from"./index-CNyG6qvn.js";const c=class c{constructor(){}static getInstance(){return c.instance||(c.instance=new c),c.instance}async createCategory(a){try{const o={...a,createdAt:D(),syncVersion:1};return(await f(d(i,"categories"),o)).id}catch(o){throw console.error("Erro ao criar categoria:",o),o}}async getCategories(a){console.log("üîç Buscando categorias para household:",a);try{const o=h(d(i,"categories"),m("householdId","==",a),p("createdAt","desc")),r=(await C(o)).docs.map(t=>{var s;return{id:t.id,...t.data(),createdAt:((s=t.data().createdAt)==null?void 0:s.toDate())||new Date}});return console.log(`üìã Encontradas ${r.length} categorias:`,r),r}catch(o){throw console.error("Erro ao buscar categorias:",o),o}}subscribeToCategories(a,o){console.log("üëÇ Iniciando subscription para categorias do household:",a);try{const e=h(d(i,"categories"),m("householdId","==",a),p("createdAt","desc"));return E(e,r=>{const t=r.docs.map(s=>{var l;return{id:s.id,...s.data(),createdAt:((l=s.data().createdAt)==null?void 0:l.toDate())||new Date}});console.log(`üîÑ Subscription: Encontradas ${t.length} categorias`),o(t)})}catch(e){throw console.error("Erro ao escutar categorias:",e),e}}async updateCategory(a,o){try{const e=B(i,"categories",a),r={...o,syncVersion:(o.syncVersion||0)+1};await A(e,r)}catch(e){throw console.error("Erro ao atualizar categoria:",e),e}}async createDefaultCategories(a,o){console.log("üèóÔ∏è Criando categorias padr√£o para household:",a);const e=[{name:"Alimenta√ß√£o",color:"#10B981",icon:"utensils"},{name:"Transporte",color:"#3B82F6",icon:"car"},{name:"Moradia",color:"#F59E0B",icon:"home"},{name:"Sa√∫de",color:"#EF4444",icon:"heart"},{name:"Entretenimento",color:"#8B5CF6",icon:"gamepad-2"},{name:"Compras",color:"#06B6D4",icon:"shopping-bag"},{name:"Outros",color:"#6B7280",icon:"more-horizontal"}];try{for(const r of e){const t=await this.createCategory({householdId:a,name:r.name,color:r.color,icon:r.icon,isDefault:!0,createdBy:o});console.log(`‚úÖ Categoria criada: ${r.name} (ID: ${t})`)}console.log("üéâ Todas as categorias padr√£o foram criadas com sucesso!")}catch(r){throw console.error("‚ùå Erro ao criar categorias padr√£o:",r),r}}};u(c,"instance");let g=c;const I=g.getInstance();export{g as FirebaseCategoryService,I as firebaseCategoryService};
